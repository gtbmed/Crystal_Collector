<!DOCTYPE html>
<html lang="en">
<head>
	<title>Week 4 Test</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

	<!-- Optional theme -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

	<link rel="stylesheet" type="text/css" href="Assets/css/style.css">
</head>
<body>
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<div class="container">
		<div class="row">
			<div class="page-header">
				<h1>Crystals Collector!</h1>
			</div>
		</div>

		<div class=" row instructionsBox">
			<p>Here's this crystal game</p>
		</div>

		<div class="row targetBox">
			<h3>Your Number to Match: <span class="targetNumberBox"></span></h3>
		</div>

		<div class="row">
			<div id="crystalBoxes">
			</div>
		</div>

		<div class="row numberBox">
			<h3>Your Number: <span class="yourSum"></span></h3>
		</div>

		<div class="row winLose">
			<h4>Wins: <span class="yourWins"></span></h4>
			<h4>Loses: <span class="yourLosses"></span></h4>
		</div>
	</div>

<script type="text/javascript">
$(document).ready(function() {

	// Set our target number
	var targetNumber = 19 + Math.floor(Math.random() * 120);
	console.log("target " + targetNumber);
	$(".targetNumberBox").text(targetNumber);
	
	// Global Variables
	// Player Value that increase with each crystal click
	var playerValue = 0;
	$(".yourSum").text(playerValue);

	//Wins and losses and getting them to appear on the page
	var win = 0;
	$(".yourWins").text(win);
	var lose = 0;
	$(".yourLosses").text(lose);

	var crystalValues = [];
	//crystalColors allows use add CSS classes
	// with individual attributes for each gem color
	var crystalColors = ["redGem", "blueGem", "yellowGem", "greenGem"];

	//We'll make our game setup be a function so that it can be called again after each win or loss.
	function newGame() {
		for (var i = 0; i < crystalColors.length; i++) {
			crystalValues[i] = 1 + Math.floor(Math.random() * 12);
			console.log(crystalValues);
			var crystals = $("<img>");
			//Do I need a separate class to click on or can I make the object clicked on be an existing one?  
			//I don't know so lets make one
			crystals.addClass("crystalClick");
			crystals.addClass(crystalColors[i]);
			// Can't get crystalBox to add with the crystalColors class possibly because one is a string the other is a call to an array with strings
			crystals.addClass("crystalBox");  
			crystals.attr("data-crystalvalue", crystalValues[i]);
			$("#crystalBoxes").append(crystals);
		}
	}
	newGame();
	//Function to add the values from each crystal clicked on to our total.  
	// This taken from the CrystalExample and modified to fit the assignment.

	//
	$(".crystalClick").on("click", function() {
		//Get the assigned crystal value by calling it with jquery and assinging it to a variable
		var addValue = ($(this).attr("data-crystalvalue"));
		// Here we'll parse the value of the crystal clicked since calling it with jquery gives a string
    	addValue = parseInt(addValue);

   		playerValue += addValue;
   		$(".yourSum").text(playerValue);

   		//Win / Lose conditions and what to do next

   		if (playerValue === targetNumber) {
   			alert("You Win!");
   			win++;
   			$(".yourWins").text(win);
   			crystalValues = [];
   			$("#crystalBoxes").detach();
   			playerValue = 0;
   			$(".yourSum").text(playerValue);
   			targetNumber = 19 + Math.floor(Math.random() * 120);
   			$(".targetNumberBox").text(targetNumber);
   			newGame();
   		}

   		else if (playerValue >= targetNumber) {
   			alert("You Lose!");
   			lose++;
   			$(".yourLosses").text(lose);
   			crystalValues = [];
   			$("#crystalBoxes").detach();
   			playerValue = 0;
   			$(".yourSum").text(playerValue);
   			targetNumber = 19 + Math.floor(Math.random() * 120);
   			$(".targetNumberBox").text(targetNumber);
   			newGame();
   		}
	});

});
</script>
</body>
</html>